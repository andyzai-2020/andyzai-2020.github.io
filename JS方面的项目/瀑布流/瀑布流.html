<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        *{
            margin: 0;
            padding: 0;
        }
        img{
            vertical-align: bottom;
        }
        .box{
            width: 1180px;
            margin:50px auto;
            position: relative;
        }
        .box .item{
            width: 220px;
            border:1px solid #ccc;
            border-radius: 8px;
            overflow: hidden;
            position: absolute;
            left: 0;
            top: 0;
        }
        .box .item .bigImg{
            width: 100%;
        }
        .box .item .bottom_box{
            height: 80px;
            padding:15px;
        }
        .box .item .bottom_box .user_box{
            margin-top: 15px;
        }
        .box .item .bottom_box .user_box .left{
            float: left;
        }
        .box .item .bottom_box .user_box .right{
            float: right;
        }
        .box .item .bottom_box .user_box .user_img{
            width: 30px;
            height: 30px;
            border-radius: 50%;
            margin-right: 10px;
            vertical-align: middle;
        }
        .box .item .bottom_box .user_box .username{
            font-size:12px;
            color:#555555;
        }
        .box .item .bottom_box .user_box .heart{
            height: 16px;
            vertical-align: middle;
        }
        .box .item .bottom_box .user_box .num{
            font-size:12px;
            color:#555555;
        }

        .box .item::after{
            width: 100%;
            height: 100%;
            background-color: rgba(0,2,4,.2);
            position: absolute;
            top: 0;
            left: 0;
            border-radius: 8px;
            content: "";
            cursor: pointer;
            display: none;
        }
        .box .item:hover::after{
            display:block;
        }
        .more{
            color:#ff2741;
            text-align: center;
            height: 100px;
            line-height: 100px;
            font-weight: bold;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="box">
        <div class="item">
            <img src="images/pic/01.jpg" class="bigImg"/>

            <div class="bottom_box">
                <p>æ‹¥æœ‰ä¸€å°å®¾åˆ©GTï¼Œå¦‚ä½•æ‹ï¼Œæ‰ä¸ä¼šè¢«è¯´ç‚«å¯Œï¼Ÿ</p>

                <div class="user_box">
                    <div class="left">
                        <img src="images/touxiang/01.jpg" class="user_img"/>
                        <span class="username">é‡‘è‹±ç„•</span>
                    </div>

                    <div class="right">
                        <img src="images/heart.png" class="heart"/>
                        <span class="num">101</span>
                    </div>
                </div>

            </div>

        </div>

        <div class="item">
            <img src="images/pic/02.jpg" class="bigImg"/>

            <div class="bottom_box">
                <p>ğŸ›æ¸…å‡‰ä¸€å¤ï¼Œå®å®ç”¨çš„è¿™äº›ä¸œè¥¿ä½ ğŸ‰çŸ¥é“â€¦</p>

                <div class="user_box">
                    <div class="left">
                        <img src="images/touxiang/02.jpg" class="user_img"/>
                        <span class="username">æˆ‘æ˜¯ç‰›æ²¹æœå‘€å‘€</span>
                    </div>

                    <div class="right">
                        <img src="images/heart.png" class="heart"/>
                        <span class="num">112</span>
                    </div>
                </div>

            </div>

        </div>

        <div class="item">
            <img src="images/pic/03.jpg" class="bigImg"/>

            <div class="bottom_box">
                <p>è¿™äº›è¶…ç«çš„åŠ¨æ¼«å°è¯ä½ ç»å¯¹éƒ½æœ‰å¬è¿‡</p>

                <div class="user_box">
                    <div class="left">
                        <img src="images/touxiang/03.jpg" class="user_img"/>
                        <span class="username">å­¦è¯´æ—¥è¯­</span>
                    </div>

                    <div class="right">
                        <img src="images/heart.png" class="heart"/>
                        <span class="num">305</span>
                    </div>
                </div>

            </div>

        </div>

        <div class="item">
            <img src="images/pic/04.jpg" class="bigImg"/>

            <div class="bottom_box">
                <p>é«˜æ®µä½çš„ç§‘å­¦è‚²å„¿ç†å¿µï¼åŸæ¥æ˜¯å®ƒï½</p>

                <div class="user_box">
                    <div class="left">
                        <img src="images/touxiang/04.jpg" class="user_img"/>
                        <span class="username">å°è¿·å§å„¿æ˜¯è±†è±†é¾™</span>
                    </div>

                    <div class="right">
                        <img src="images/heart.png" class="heart"/>
                        <span class="num">101</span>
                    </div>
                </div>

            </div>

        </div>

        <div class="item">
            <img src="images/pic/05.jpg" class="bigImg"/>

            <div class="bottom_box">
                <p>æ²¡æƒ³åˆ°å› ä¸ºå©´å„¿æ¨è½¦ï¼Œæˆ‘å±…ç„¶è¢«å­©å­çˆ¸å¤¸äº†â€¦</p>

                <div class="user_box">
                    <div class="left">
                        <img src="images/touxiang/05.jpg" class="user_img"/>
                        <span class="username">æˆ‘æ˜¯ç‰›æ²¹æœå‘€å‘€</span>
                    </div>

                    <div class="right">
                        <img src="images/heart.png" class="heart"/>
                        <span class="num">164</span>
                    </div>
                </div>

            </div>

        </div>

        <div class="item">
            <img src="images/pic/06.jpg" class="bigImg"/>

            <div class="bottom_box">
                <p>æ—¥å¸¸vlogï½œå¦ˆå¦ˆã€åšä¸»ï¼Œæ¯å¤©èº«ä»½è½¬æ¢</p>

                <div class="user_box">
                    <div class="left">
                        <img src="images/touxiang/06.jpg" class="user_img"/>
                        <span class="username">æœ¨å¤•_æœ¨</span>
                    </div>

                    <div class="right">
                        <img src="images/heart.png" class="heart"/>
                        <span class="num">976</span>
                    </div>
                </div>

            </div>

        </div>

        <div class="item">
            <img src="images/pic/07.jpg" class="bigImg"/>

            <div class="bottom_box">
                <p>è¿™ä¸ªé£Ÿè°±æ‘†æ‘Šèƒ½ä¸èƒ½èµšåˆ°å­¦è´¹å¤§å®¶å¸®å¿™å‚è€ƒä¸€ä¸‹ğŸ˜‚</p>

                <div class="user_box">
                    <div class="left">
                        <img src="images/touxiang/07.jpg" class="user_img"/>
                        <span class="username">å½­é›¨è·baby</span>
                    </div>

                    <div class="right">
                        <img src="images/heart.png" class="heart"/>
                        <span class="num">1373</span>
                    </div>
                </div>

            </div>

        </div>

        <div class="item">
            <img src="images/pic/08.jpg" class="bigImg"/>

            <div class="bottom_box">
                <p>å’Œæ²¹æ±¡èŸ‘è‚say byebyeï½œå¨æˆ¿æ¸…æ´å¥½ç‰©åˆ†äº«</p>

                <div class="user_box">
                    <div class="left">
                        <img src="images/touxiang/08.jpg" class="user_img"/>
                        <span class="username">Cikoe</span>
                    </div>

                    <div class="right">
                        <img src="images/heart.png" class="heart"/>
                        <span class="num">60</span>
                    </div>
                </div>

            </div>

        </div>

        <div class="item">
            <img src="images/pic/09.jpg" class="bigImg"/>

            <div class="bottom_box">
                <p>å’Œæ²¹æ±¡èŸ‘è‚say ä¸Šè¡—è¶…æƒ¹çœ¼å®å…‰MINI EVï¼Œå¸‚åŒºä»£æ­¥è½¦æ€§ä»·é«˜</p>

                <div class="user_box">
                    <div class="left">
                        <img src="images/touxiang/09.jpg" class="user_img"/>
                        <span class="username">ä¸€é¢—å°ç”œæ¬£</span>
                    </div>

                    <div class="right">
                        <img src="images/heart.png" class="heart"/>
                        <span class="num">80</span>
                    </div>
                </div>

            </div>

        </div>

        <div class="item">
            <img src="images/pic/10.jpg" class="bigImg"/>
            <div class="bottom_box">
                <p>ğŸ“¢å¿«å¼€å­¦äº†ï¼ï¼ï¼å†ä¸å‡†å¤‡å°±æ™šäº†âœ…</p>

                <div class="user_box">
                    <div class="left">
                        <img src="images/touxiang/10.jpg" class="user_img"/>
                        <span class="username">æˆ‘å«å°è±†æµ†</span>
                    </div>

                    <div class="right">
                        <img src="images/heart.png" class="heart"/>
                        <span class="num">261</span>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <div class="more">æŸ¥çœ‹æ›´å¤š</div>

    <script src="js/jquery.min.js"></script>
    <script>
        // å¾—åˆ°æœ€å¤§åˆ—æ•°
        var column = Math.floor( $(".box").width()/$(".item").outerWidth() );

        // å®šä¹‰ä¸€ä¸ªå˜é‡,ä¿å­˜æ¯ä¸ª.itemä¹‹é—´çš„é—´éš”
        var gap = 18;

        // å®šä¹‰ä¸€ä¸ªæ•°ç»„,ä¿å­˜æ¯åˆ—çš„æ€»é«˜åº¦
        var arrHeight = [];

        // éå†æ¯ä¸ª.itemå¯¹è±¡
        $(".item").each(function(index, domElement ){
            // ç€‘å¸ƒæµå®ç°ç¬¬ä¸€åˆ—æ’åˆ—
            // ç¬¬ä¸€åˆ—å›¾ç‰‡çš„topå€¼éƒ½æ˜¯0
            // ç¬¬ä¸€åˆ—ç¬¬1ä¸ªå›¾ç‰‡çš„leftå€¼æ˜¯0
            // ç¬¬ä¸€åˆ—ç¬¬2ä¸ªå›¾ç‰‡çš„leftå€¼æ˜¯ (å›¾ç‰‡ç›’å­å®½åº¦+é—´éš”)*1
            // ç¬¬ä¸€åˆ—ç¬¬3ä¸ªå›¾ç‰‡çš„leftå€¼æ˜¯ (å›¾ç‰‡ç›’å­å®½åº¦+é—´éš”)*2
            // ç¬¬ä¸€åˆ—ç¬¬4ä¸ªå›¾ç‰‡çš„leftå€¼æ˜¯ (å›¾ç‰‡ç›’å­å®½åº¦+é—´éš”)*3
            // ç¬¬ä¸€åˆ—ç¬¬5ä¸ªå›¾ç‰‡çš„leftå€¼æ˜¯ (å›¾ç‰‡ç›’å­å®½åº¦+é—´éš”)*4
            if( index < column ){// ç¬¬ä¸€åˆ—
                $(domElement).css({
                    top: 0,
                    left: ( $(domElement).outerWidth()+gap ) * index
                })

                // ä¿å­˜ç¬¬ä¸€è¡Œå›¾ç‰‡ç›’å­çš„é«˜åº¦åˆ°æ•°ç»„
                arrHeight.push( $(domElement).outerHeight() )

            }else{
                // é™¤ç¬¬ä¸€è¡Œä¹‹å¤–çš„å…¶ä»–åˆ—
                // æ‰¾å‡ºé«˜åº¦æ•°ç»„ä¸­,æœ€å°åˆ—çš„é«˜åº¦å€¼
                var minHeight =  Math.min.apply(null , arrHeight ) ;

                // æœ€å°åˆ—é«˜åº¦å€¼å¯¹åº”çš„ç´¢å¼•å·
                // jQuery.inArray(value,array)
                // ç¡®å®šç¬¬ä¸€ä¸ªå‚æ•°åœ¨æ•°ç»„ä¸­çš„ä½ç½®ï¼Œä»0å¼€å§‹è®¡æ•°(å¦‚æœæ²¡æœ‰æ‰¾åˆ°åˆ™è¿”å› -1 )ã€‚
                var minIndex = $.inArray( minHeight , arrHeight );

                // è®¾ç½®åç§»é‡
                $(domElement).css({
                    top: minHeight + gap,
                    left: ( $(domElement).outerWidth()+gap ) * minIndex
                })

                // æ›´æ–°å¯¹åº”åˆ—çš„é«˜åº¦å€¼  è¿™æ­¥å¾ˆå…³é”®
                arrHeight[minIndex] = minHeight + gap + $(domElement).outerHeight()
            }
            
        })
        
        // ç»™ç€‘å¸ƒæµçˆ¶å®¹å™¨è®¾ç½®æœ€å¤§åˆ—é«˜åº¦
        var maxHeight =  Math.max.apply(null , arrHeight ) ;
        $(".box").height( maxHeight );


        var newData = [
            {
                "img_num" : 11,
                "img_desc" : "è†ç”°æ¢åº—ï½œæ—¶é›¾ç¾æœ¯é¦†",
                "username" : "iamlittley",
                "num": 43
            },{
                "img_num" : 12,
                "img_desc" : "å‚åŠ æ´»åŠ¨é‡åˆ°å–œæ¬¢åšä¸» ç¬é—´å˜æˆå°è¿·å¦¹",
                "username" : "Chiliå¾è¾£å„¿",
                "num": 112
            },{
                "img_num" : 13,
                "img_desc" : "å­¦ä¹ å¹²è´§ğŸ“–å„ç§‘ç¬”è®°è®°ä»€ä¹ˆï¼Œä¸çœ‹åæ‚”âœ“",
                "username" : "è´ºå«å…½",
                "num": 1687
            }
        ]


        // ç‚¹å‡»æŸ¥çœ‹æ›´å¤š,æ·»åŠ .itemé¡¹
        $(".more").click(function(){
            $.each(newData,function (index,item) {
                    // åˆ›å»ºæ–°çš„.item
                    var newItem = $("<div class='item'></div>");
                    // è®¾ç½®æ–°çš„.itemå†…å®¹  es6ä¸­æ¨¡æ¿å­—ç¬¦ä¸²``   æ¨¡æ¿æ˜¯å…è®¸æ¢è¡Œ   åœ¨``é‡Œé¢å¯ä»¥ä½¿ç”¨ ${å˜é‡å} è§£æå˜é‡ 
                    newItem.html(`<img src="images/pic/${item["img_num"]}.jpg" class="bigImg"/>
                    <div class="bottom_box">
                        <p>${item["img_desc"]}</p>

                        <div class="user_box">
                            <div class="left">
                                <img src="images/touxiang/${item["img_num"]}.jpg" class="user_img"/>
                                <span class="username">${item["username"]}</span>
                            </div>

                            <div class="right">
                                <img src="images/heart.png" class="heart"/>
                                <span class="num">${item["num"]}</span>
                            </div>
                        </div>
                    </div>`);

                    // æŠŠæ–°çš„.itemè¿½åŠ æ‰“.boxä¸­
                    $(".box").append( newItem );
                    newItem.hide();


                    // å› ä¸ºå›¾ç‰‡åŠ è½½éœ€è¦æ—¶é—´,æ‰€ä»¥æ”¾åœ¨å»¶æ—¶å™¨ä¸­æ‰§è¡Œéƒ¨åˆ†ä»£ç ,è¿™æ ·æ‰èƒ½ä¿è¯å›¾ç‰‡å®½åº¦é«˜åº¦èƒ½æ­£ç¡®è·å–åˆ°
                    setTimeout(function(){
                        console.log( newItem.outerHeight() );
                        // æ‰¾å‡ºé«˜åº¦æ•°ç»„ä¸­,æœ€å°åˆ—çš„é«˜åº¦å€¼
                        var minHeight =  Math.min.apply(null , arrHeight ) ;

                        // æœ€å°åˆ—é«˜åº¦å€¼å¯¹åº”çš„ç´¢å¼•å·
                        var minIndex = $.inArray( minHeight , arrHeight );

                        // è®¾ç½®åç§»é‡
                        newItem.css({
                            top: minHeight + gap,
                            left: ( newItem.outerWidth()+gap ) * minIndex
                        })

                        // æ›´æ–°å¯¹åº”åˆ—çš„é«˜åº¦å€¼  è¿™æ­¥å¾ˆå…³é”®
                        arrHeight[minIndex] = minHeight + gap + newItem.outerHeight();


                        // ç»™ç€‘å¸ƒæµçˆ¶å®¹å™¨è®¾ç½®æœ€å¤§åˆ—é«˜åº¦
                        var maxHeight =  Math.max.apply(null , arrHeight ) ;
                        $(".box").height( maxHeight );
                        newItem.fadeIn(1000);
                    },100 )
            })
            

        })
    </script>
</body>
</html>